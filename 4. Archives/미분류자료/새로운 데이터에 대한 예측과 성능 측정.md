새로운 데이터에 대한 예측과 성능 측정

실제 세계에서 모델이 제대로 작동하는지 알아보기 위해서는 훈련 데이터 셋에 포함되지 않은 새로운 데이터를 가지고 검증을 해봐야 한다. 이렇게 모델의 성능을 테스트하기 위한 사례들의 집합을 검증 집합(validation set), 테스트 집합(test set), 홀드아웃 집합(holdout set) 등으로 부른다.

#### 유의사항
훈련용 데이터 셋을 준비할 때는 임신 대 비임신을 50/50으로 설정하여 임신 그룹을 과대 샘플링했짐나, 검증을 위한 데이터 셋에서는 임신 비율을 실제 비율에 맞게 해야 한다. 이것은 모델이 실제 상황에서 제대로 성능을 발휘하는지 제대로 측정하기 위함이다.

#### 예측 모델 성능 비교 척도
예측 모델에 대한 여러 종류의 성능 비교 척도가 많지만, 그것들은 아래의 4개의 값의 조합에 다라 만들어지는 것이 대부분이다.

* 진 양성 : 임신한 경우를 임신했다고 함
* 진 음성 : 임신하지 않은 경우를 임신하지 않았다고 함
* 위 양성(타입 I 에러) : 임신하지 않았는데, 임신했다고 함
* 위 음성(타입 II 에러) : 임신한 경우를 임신하지 않았다고 함

##### 정밀도 : 양성예측도
정밀도는 컷오프 기준으로 모델이 임신한 가구라고 예측한 가구 중에서 실제로 임신한 가구의 비율을 말한다. 컷오프 기준으로 모델이 얼마나 정확하게 예측했는가를 알려주는 지표이다. 따라서 컷오프 기준이 높을수록 정밀도도 높아진다.


##### 민감도 : 진 양성 비율
민감도는 컷오프 통과하는 실제 임신한 가구가 전체 실제 임신한 가구 중 몇 % 비율을 차지하는지를 나타내는 지표이다. 따라서 컷오프 기준이 낮을수록 민감도는 높은 것으로 나온다.

#### 트레이드오프와 ROC 곡선
컷오프가 올라갈수록 모델의 정밀도는 올라가지만, 민감도는 떨어진다. 이런 성능 척도들의 트레이드오프 관계를 평가하기 위해 가장 흔하게 사용하는 것 중 하나가 ROC 곡선이다.

ROC 곡선은 컷오프 선택에 따른 위 양성 비율과 진 양성 비율과의 관계를 보여주는 단순한 그래프이다. 예를 들어, 어떤 예측모델에 대해서 컷오프로 0.85를 선택했을 때, 위 양성이 0%이고, 진 양성이 40%라면, 이것이 의미하는 것은 위 양성이 나오지 않는 상태에서 진짜로 임신한 경우(진 양성)를 40% 가려낼 수 있다는 말이다.

#### ROC 곡선을 통해 더 좋은 예측 모델 선택하기
ROC 곡선은 가능하면 Y값이 1로 빨리 뛰어 올라가서 거기에서 안정적인 상태를 유지하는 것이다 좋다. 이것이 의미하는 것은 위 양성을 최소로하면서, 진 양성이 최대가 되게하는 예측 모델이 더 우수한 모델이라는 의미이다(이것은 내 의견임).

결론적으로 그래프 아래의 면적이 큰 모델이 우수한 모델이다.



