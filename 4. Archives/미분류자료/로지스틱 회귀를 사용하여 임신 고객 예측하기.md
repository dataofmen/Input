로지스틱 회귀를 사용하여 임신 고객 예측하기

### 로즈스틱 회귀를 하는 이유
임신 여부를 예측하는 선형 회귀 모델에서는 예측값이 1.22거나 -0.35라고 했을 때, 이것은 122퍼센트 확률이나 -35퍼센트 확률로 임신할 수 있다는 것을 뜻하지 않는다. 즉, 예측값 자체가 그룹의 클래스를 분리해 주는 확률은 아니라는 것이다.

모델의 예측값이 실제로 분류 확률이 되는 모델이 바로 '로지스틱 회귀'이다.


### 먼저 링크 함수가 필요하다
선형 회귀 모델의 예측값을 실제 분류 확률이 되도록 해주려면 링크 함수가 필요하다.

임신 여부를 예측하는 경우 예측 결과는 0(비임신) 또는 1(임신)이다. 따라서 선형 모델의 예측값을 0과 1 사이에 머물 수 있도록 만들어 주는 함수가 필요하다. 이런 함수를 링크 함수(link function)이라고 부른다.

링크 함수 중에서 대표적인 것인 아래의 함수이다.

y = exp(x) / (1 + exp(x))

exp(x)는 e를 밑으로하며, x를 지수로 하는 함수를 말한다. x값이 무한히 커져도 y값은 1에 수렴하고, x값이 무한히 작아져도 0에 수렴한다.


### 최대우도법
로지스틱 회귀에서는 오차제곱의 합을 최소화하는 방법으로 최대우도법을 사용한다. 우도는 아래와 같이 계산한다.

P^y (1-p)^(1-y)

우도에 로그를 취하면 아래와 같다.

y*ln(p) + (1-y)*ln(1-p)




